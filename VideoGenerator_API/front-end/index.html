<!doctype html>
<html>
  <body style="font-family: system-ui; max-width: 720px; margin: 2rem auto;">
    <h2>VoltagePark Textâ†’Video (MVP)</h2>
    <form id="f" style="margin-bottom:1rem">
      <input name="prompt" placeholder="Describe your video" style="width:420px;padding:.5rem">
      <button style="padding:.5rem 1rem">Generate</button>
    </form>
    <pre id="out" style="background:#f6f6f6;padding:1rem;border-radius:8px;height:300px;overflow:auto"></pre>
    <script>
      const out = document.getElementById('out');
      document.getElementById('f').onsubmit = async (e)=>{
        e.preventDefault();
        const prompt = new FormData(e.target).get('prompt');
        let r = await fetch('/jobs', {method:'POST', headers:{'Content-Type':'application/json'},
          body: JSON.stringify({prompt})});
        let {job_id} = await r.json();
        out.textContent = 'job: '+job_id+'\nPolling...';
        let t = setInterval(async ()=>{
          let s = await fetch('/jobs/'+job_id); s = await s.json();
          out.textContent = JSON.stringify(s,null,2);
          if (s.status === 'completed' && s.result_url){ clearInterval(t); }
          if (s.status === 'failed'){ clearInterval(t); }
        }, 1500);
      };
    </script>
  </body>
</html>
